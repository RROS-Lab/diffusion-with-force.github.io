<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Diffusion Policy: Diffusion with force</title>

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-120436611-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-120436611-3');
    </script>
    <script type="text/javascript">google.load("jquery", "1.3.2");</script>
    <script src="video.js"></script>

    <link rel="StyleSheet" href="style.css" type="text/css"/>
    <style>
      .header {
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
        gap: 20px;
        max-width: 1200px;
        margin: 0 auto;
        background-color: #fff;
      }

      .usc-logo {
        height: 120px;
        width: auto;
      }

      .header .title {
        font-size: 24px;
        margin: 0;
        color: #333;
        font-family: Arial, sans-serif;
      }
    </style>
  </head>
  
  <body>
    <div class="header">
      <img src="images/usc-logo.png" alt="USC Logo" class="usc-logo">
    </div>

    <center>
      <h1 class="title">Compliant Object Manipulation for Tight Tolerance Object Using Diffusion
        Policy with Force Modality</h1>
    </center>

    <br>
    <table align=center width=1000px>
      <tr>
        <td align=center width=150px>
          <center>
            <span class="author">Jeon Ho Kang</a><sup>1</sup></span>
          </center>
        </td>
        <td align=center width=150px>
          <center>
            <span class="author">Sagar Joshi</a><sup>1</sup></span>
          </center>
        </td>
        <td align=center width=150px>
          <center>
            <span class="author">Ruopeng Huang</a><sup>1</sup></span>
          </center>
        </td>
        <td align=center width=190px>
          <center>
            <span class="author">Satyandra K. Gupta</a><sup>1</sup></span>
          </center>
        </td>
      </tr>
    </table>

    <table align=center width=700px>
      <tr>
        <td align=center width=100px>
          <center>
            <span class="author"><sup>1</sup>University of Southern California</span>
          </center>
        </td>
      </tr>
    </table>

    <div class="container">
      <table align=center width=60%>
        <tr>
          <td align=center width=50%>
            <center>
              <img class="layered-paper" width=15% src="images/page2.png"/>
              <p class="sectitle">Paper</a></p>
            </center>
          </td>
          <td align=center width=50%>
            <center>
              <img width=15% src="images/github.png"/>
              <p class="sectitle"><a href="https://github.com/JeonHoKang/Diffusion_Policy_ICRA">Code</a></p>
            </center>
          </td>
        </tr>
      </table>
    </div>

    <div class="container demo-videos">
      <center><h2 class="sectitle">Project Demos</h2></center>
      <div class="video-row">
        <div class="video-case">
          <video controls playsinline autoplay muted loop>
            <source src="videos/4aaa_pry_success.mp4" type="video/mp4">
          </video>
          <p class="caption">AAA Battery</p>
        </div>
        <div class="video-case">
          <video controls playsinline autoplay muted loop>
            <source src="videos/2aa_pry_success.mp4" type="video/mp4">
          </video>
          <p class="caption">AA Battery</p>
        </div>
        <div class="video-case">
          <video controls playsinline autoplay muted loop>
            <source src="videos/2c_pry_success.mp4" type="video/mp4">
          </video>
          <p class="caption">C Battery</p>
        </div>
        <div class="video-case">
          <video controls playsinline autoplay muted loop>
            <source src="videos/2d_pry_success.mp4" type="video/mp4">
          </video>
          <p class="caption">D Battery</p>
        </div>
      </div>
    </div>

    <div class="container" id="network">
      <center><h2 class="sectitle">Network Architecture</h2></center>
      <div class="container">
        <img src="images/system_architecture_opt3.png"></img>
      </div>
    </div>

    <div class="container" id="abstract">
      <center><h2 class="sectitle">Abstract</h2></center>
      <p class="text">
        Usage of battery powered products have been
        significantly increasing in recent years from automotive, house
        hold products and electronics. However, compared to increase
        in manufactured batteries, means to recycle and repurpose
        batteries is limited. Batteries are usually stored in casing or
        products in fastened manner and is often hard to manipulate
        and allow for little tolerance. To address this issue, we propose
        battery extraction from different parts using diffusion policy
        that have proven to be able to learn from human behavior
        and robustly learn sequence of actions. Particularly, this work
        proposes a diffusion policy for action generation conditioned
        on vision and force data. We validate our method on bimanual
        setup where one arm is responsible for battery extraction
        and the other arm is responsible for holding, transporting
        and dumping the extracted batteries. We test our method
        on various kinds of battery-powered products and show that
        our model can effectively perform extraction of the battery.
        Our contributions include a full robotic framework for battery
        extraction and recycling and a novel approach to encode force
        data for diffusion policy training for conditioning generated
        actions on extra sensor modality. 
      </p>
    </div>

    <div class="container" id="battery-images">
      <h2 class="sectitle">Images of Battery Products</h2>
      <div class="container image-container">
        <img src="images/ex_products.png" alt="Battery Products" class="centered-image">
      </div>
    </div>

    <div class="container" id="result">
      <center><h2 class="sectitle">Image Results</h2></center>
      <div class="table-container">
          <style>
              .results-table {
                  width: 100%;
                  border-collapse: collapse;
                  margin: 20px 0;
                  font-size: 14px;
              }
  
              .results-table th, .results-table td {
                  border: 1px solid #ddd;
                  padding: 8px;
                  text-align: center;
              }
  
              .results-table th {
                  background-color: #f5f5f5;
                  font-weight: bold;
              }
  
              .results-table .highlight {
                  font-weight: bold;
              }
          </style>
  
          <table class="results-table">
              <tr>
                  <th rowspan="2"></th>
                  <th colspan="4">AAA</th>
                  <th colspan="4">AA</th>
                  <th colspan="4">C</th>
                  <th colspan="4">D</th>
                  <th rowspan="2">Avg. Success Rate</th>
              </tr>
              <tr>
                  <th>Obj1</th>
                  <th>Obj2*</th>
                  <th>Obj3*</th>
                  <th>Avg.</th>
                  <th>Obj4</th>
                  <th>Obj5</th>
                  <th>Obj6</th>
                  <th>Avg.</th>
                  <th>Obj7</th>
                  <th>Obj8</th>
                  <th>Obj9</th>
                  <th>Avg.</th>
                  <th>Obj10</th>
                  <th>Obj11*</th>
                  <th>Obj12*</th>
                  <th>Avg.</th>
              </tr>
              <tr>
                  <td>DP-B</td>
                  <td>0.0</td>
                  <td>0.5</td>
                  <td>0.7</td>
                  <td>0.4</td>
                  <td>0.2</td>
                  <td>0.3</td>
                  <td>0.1</td>
                  <td>0.2</td>
                  <td>0.4</td>
                  <td>0.4</td>
                  <td>0.3</td>
                  <td>0.37</td>
                  <td>0.4</td>
                  <td>0.8</td>
                  <td>0.6</td>
                  <td>0.6</td>
                  <td>0.41</td>
              </tr>
              <tr>
                  <td>DP-LF</td>
                  <td>0.2</td>
                  <td>0.4</td>
                  <td>0.7</td>
                  <td>0.43</td>
                  <td>0.5</td>
                  <td>0.4</td>
                  <td>0.3</td>
                  <td>0.4</td>
                  <td>0.1</td>
                  <td>0.4</td>
                  <td>0.8</td>
                  <td>0.43</td>
                  <td>0.6</td>
                  <td>0.5</td>
                  <td>0.9</td>
                  <td>0.67</td>
                  <td>0.53</td>
              </tr>
              <tr>
                  <td>DP-PF</td>
                  <td>0.4</td>
                  <td>0.7</td>
                  <td>0.8</td>
                  <td>0.63</td>
                  <td>0.5</td>
                  <td>0.7</td>
                  <td>0.5</td>
                  <td>0.57</td>
                  <td>0.2</td>
                  <td>0.3</td>
                  <td>0.7</td>
                  <td>0.4</td>
                  <td>0.4</td>
                  <td>0.7</td>
                  <td>0.9</td>
                  <td>0.67</td>
                  <td>0.55</td>
              </tr>
              <tr class="highlight">
                  <td>DP-CA (Ours)</td>
                  <td>0.9</td>
                  <td>0.9</td>
                  <td>0.9</td>
                  <td>0.9</td>
                  <td>1.0</td>
                  <td>0.9</td>
                  <td>1.0</td>
                  <td>0.97</td>
                  <td>1.0</td>
                  <td>1.0</td>
                  <td>1.0</td>
                  <td>1.0</td>
                  <td>1.0</td>
                  <td>1.0</td>
                  <td>1.0</td>
                  <td>1.0</td>
                  <td>0.96</td>
              </tr>
          </table>
      </div>

      <div class="image-single">
        <div class="image-case">
          <img src="images/bar_chart_time.png" alt="Time Taken Comparison">
          <p class="caption">Comparison of Time Taken</p>
        </div>
      </div>

      <div class="bottom-images">
        <div class="image-case">
          <img src="images/force_seen.png" alt="Peak Force Comparison (In Distribution)">
          <p class="caption">Comparison of Peak Force (In Distribution)</p>
        </div>
        <div class="image-case">
          <img src="images/force_unseen.png" alt="Peak Force Comparison (Out of Distribution)">
          <p class="caption">Comparison of Peak Force (Out of Distribution)</p>
        </div>
      </div>

      <div class="image-single">
        <div class="image-case">
          <img src="images/force_line.png" alt="Force Trend" class="small-image">
          <p class="caption">Force Trend Over Time</p>
        </div>
      </div>
      <div class="image-single">
        <div class="image-case">
          <img src="images/failure_force.png" alt="Failure Mode" class="large-image">
          <p class="caption">Representative Failure Mode</p>
        </div>
      </div>
    </div>

    <div class="container" id="failure-cases">
      <center><h2 class="sectitle">Representative Failure Cases</h2></center>
      <div class="failure-grid">
        <div class="video-case">
          <video controls playsinline autoplay muted loop>
            <source src="videos/fail1-converted.mp4" type="video/mp4">
          </video>
          <p class="caption">Failure Mode 1</p>
        </div>
        <div class="video-case">
          <video controls playsinline autoplay muted loop>
            <source src="videos/fail2-converted.mp4" type="video/mp4">
          </video>
          <p class="caption">Failure Mode 2</p>
        </div>
        <div class="video-case">
          <video controls playsinline autoplay muted loop>
            <source src="videos/fail3.mp4" type="video/mp4">
          </video>
          <p class="caption">Failure Mode 3</p>
        </div>
        <div class="video-case">
          <video controls playsinline autoplay muted loop>
            <source src="videos/fail4-converted.mp4" type="video/mp4">
          </video>
          <p class="caption">Failure Mode 4</p>
        </div>
      </div>
    </div>
  </body>
</html>